<% layout('../layout') -%>
<div class="content-page">
    <!-- Start content -->
    <div class="content">
        <div class="container">

            <!-- Page-Title -->
            <% const role = user.role === 'Department' ? 'Phòng ban' : (user.role === 'Faculty'? 'Khoa' : ( user.role === 'Lecturer' ? 'Giảng viên' : 'Admin') ) %>
            <div class="row">
                <div class="col-sm-12">
                    <h4 class="page-title"><%= role %></h4>
                    <ol class="breadcrumb">
                        <li>
                            <a href="#"><%= role %></a>
                        </li>

                        <li class="active">
                            Lịch sử
                        </li>
                    </ol>
                </div>
            </div>
            <div class="row">
                <div class="col-lg-12">
                    <div class="card-box table-responsive">
                        <h4 class="m-t-0 header-title"><b>History</b></h4>
                        <table id="datatable-fixed-col" class="table table-striped table-bordered">
                            <thead>
                            <tr>
                                <th>Id</th>
                                <th>Sender</th>
                                <th>Title</th>
                                <th>Content</th>
                                <th>Priority</th>
                                <th>Receiver</th>
                                <th>Created At</th>
                            </tr>
                            </thead>
                            <tbody>
                            </tbody>
                        </table>
                    </div>
                </div> <!-- end col -->
            </div>
        </div> <!-- container -->

    </div> <!-- content -->
    <footer class="footer text-right">
        © 2017. All rights reserved.
    </footer>
</div>




<script>
    $(document).ready(function () {
        var table = $('#datatable-fixed-col').dataTable({
            searching: true,
            processing:true,
            serverSide: true,
            autoWidth: true,
            ajax: '/department/manage/announce/history/data-table',
            columnDefs: [{
                "targets": -1,
                "data": null,
            }],
            order: [[ 4, "desc" ]],
            columns:[
                {data: '_id', name: '_id',"visible": false},
                {data: 'sender', name: 'sender',visible: false},
                {data: 'title', name: 'title',searchable: true, type: "string",sort: 'text',
                    fnCreatedCell: function (nTd, sData, oData, iRow, iCol) {
                        $(nTd).html("<a href='/department/manage/announce/"+oData._id+"'>"+oData.title+"</a>");
                    }},
                {data: 'description',name :'description',searchable: true,
                    fnCreatedCell: function (nTd, sData, oData, iRow, iCol) {
                        console.log(oData)
                        $(nTd).html("<a href='/department/manage/announce/"+oData._id+"'>"+oData.description+"</a>")}},
                {data: 'priorityNotify.name',name : 'priority',},
                {data: 'kindOfReceiver',name : 'kindOfReceiver',},
                {data: 'createdAt', name: 'createdAt',},

            ],
        });

    });

</script>
